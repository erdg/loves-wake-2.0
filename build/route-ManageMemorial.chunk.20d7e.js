webpackJsonp([1],{FoBm:function(t,e,n){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var r=n("KM04"),c=n("/C1n"),d=n("v23/"),h=(n("/QC5"),Object(r.h)("h4",{class:"col"},"Chronicle Items")),m=Object(r.h)("div",{class:"col"}),u=Object(r.h)("div",{class:"divider"}),f=function(t){return Object(r.h)("div",null,Object(r.h)("div",{class:"row"},h,m,Object(r.h)("button",{class:"col btn btn-primary",onClick:t.newItem},"Add Item")),u,Object(r.h)("div",{style:"display:flex;flex-direction:row;flex-wrap:wrap;align-items:flex-start;justify-content:center;"},t.items.map(function(e){return Object(r.h)(b,{id:e.id,title:e.title,date:e.start,location:e.location,src:e.src,showModal:function(e){return t.showModal(e)},edited:e.edited})})))},b=function(t){return Object(r.h)("div",{class:"card m-2",style:"width:200px;"+(t.edited?"background:lightcoral;":"")},t.src&&Object(r.h)("img",{class:"responsive-img mt-2 mx-2 centered",src:t.src,style:"max-width:182px"}),Object(r.h)("div",{class:"card-body"},Object(r.h)("div",{class:"h6 text-ellipsis"},t.title),Object(r.h)("div",{class:"text-gray text-ellipsis",style:"font-size:smaller;"},t.location),Object(r.h)("div",{class:"text-gray",style:"font-size:smaller;"},t.date)),Object(r.h)("div",{class:"card-footer"},Object(r.h)("button",{class:"btn btn-sm float-right",onClick:function(){return t.showModal(t.id)}},"edit")))},p=f,v=n("9qb7"),O=n.n(v),j=n("AM5m"),g=function(t){return Object(r.h)("div",{class:"panel"},Object(r.h)("div",{class:"panel-body mt-2"},t.item.src&&Object(r.h)("img",{src:t.item.src,alt:t.item.title,class:"img-responsive my-2"}),Object(r.h)("h4",null,t.item.title),Object(r.h)("div",{class:"text-gray d-inline"},t.item.location),Object(r.h)("div",{class:"text-gray d-inline mx-2"},t.item.start),Object(r.h)("p",null,t.item.caption)))},y=g,w=Object(r.h)("div",{class:"text-center text-gray",style:"font-size:smaller;"},"- Scroll down to see a preview -"),C=function(t){function e(){return i(this,t.apply(this,arguments))}return o(e,t),e.prototype.render=function(t){var e=O()("modal","modal-lg",{active:t.showModal},{"has-error":t.modalError}),n=window.innerWidth||document.documentElement.clientWidth||document.body.client.width;return Object(r.h)("div",{class:e},Object(r.h)("a",{onClick:t.hideModal,class:"modal-overlay","aria-label":"Close"}),Object(r.h)("div",{class:"modal-container"},Object(r.h)("div",{class:"modal-header"},Object(r.h)("a",{onClick:t.hideModal,class:"btn btn-clear float-right","aria-label":"Close"}),Object(r.h)("div",{class:"modal-title h5"},t.item.id?"Edit Item":"Add Item"),n<840&&w),Object(r.h)("div",{class:"modal-body"},Object(r.h)("div",{class:n<840?"content":"content container columns"},Object(r.h)("form",{class:n<840?"form-group":"form-group column col-5"},Object(r.h)(j.e,{label:"Title",name:"title",value:t.item.title,onChange:t.onChange}),Object(r.h)(j.e,{label:"Location",name:"location",value:t.item.location,onChange:t.onChange}),Object(r.h)(j.a,{label:"Date",name:"start",value:t.item.start,onChange:t.onChange}),Object(r.h)("label",{class:"form-label"},"Change photo",Object(r.h)("input",{class:"form-input",type:"file",accept:".jpg, .jpeg, .png",value:t.item.file,onChange:t.onFileChange}))),Object(r.h)("div",{class:n<840?"":"column col-7"},Object(r.h)(y,{item:t.item})))),Object(r.h)("div",{class:"modal-footer"},Object(r.h)("button",{class:"btn btn-primary",onClick:t.item.id?t.updChronicle:t.newChronicle},t.item.id?"Update item":"Add item"))))},e}(r.Component),x=C,M=function(t){function e(){var n,i,o;a(this,e);for(var s=arguments.length,r=Array(s),d=0;d<s;d++)r[d]=arguments[d];return n=i=l(this,t.call.apply(t,[this].concat(r))),i.state={item:{},showModal:!1},i.onChange=function(t){var e=i.state.item;e[t.target.name]=t.target.value,i.setState({oldState:e})},i.onFileChange=function(t){var e=i.state.item;e.file=t.target.files[0],i.setState({oldState:e}),i.makeFileURL()},i.makeFileURL=function(){var t=i.state.item,e=new FileReader;e.onload=function(e){t.src=e.target.result,i.setState({oldState:t})},e.readAsDataURL(i.state.item.file)},i.updChronicle=function(){if(console.log("updChronicle"),!i.state.item.title||!i.state.item.start)return void alert("A new item must have a title and a date");if(i.state.item.file){var t=new FileReader;t.readAsDataURL(i.state.item.file),t.onload=function(t){var e=t.target.result.split("=")[0];fetch(c.a+"!updChronicle?"+i.props.urlNm,{method:"POST",body:JSON.stringify({loginToken:window.sessionStorage.getItem("loginToken"),id:i.state.item.id,title:i.state.item.title,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt,image:e})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).then(i.setState({item:{}}))}}else fetch(c.a+"!updChronicle?"+i.props.urlNm,{method:"POST",body:JSON.stringify({loginToken:window.sessionStorage.getItem("loginToken"),id:i.state.item.id,title:i.state.item.title,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).then(i.setState({item:{}}));i.hideModal()},i.newChronicle=function(){if(console.log("newChronicle"),!i.state.item.title||!i.state.item.start)return void alert("A new item must have a title and a date");if(i.state.item.file){var t=new FileReader;t.readAsDataURL(i.state.item.file),t.onload=function(t){var e=t.target.result.split("=")[0];fetch(c.a+"!postChronicle?"+i.props.urlNm,{method:"POST",body:JSON.stringify({title:i.state.item.title,subtitle:i.state.item.subtitle,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt,image:e})}).then(function(t){return t.json()}).then(function(t){console.log(t),i.addItem(t)}).then(i.setState({item:{}}))}}else fetch(c.a+"!postChronicle?"+i.props.urlNm,{method:"POST",body:JSON.stringify({title:i.state.item.title,subtitle:i.state.item.subtitle,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt})}).then(function(t){return t.json()}).then(function(t){console.log(t),i.addItem(t)}).then(i.setState({item:{}}));i.hideModal()},i.showModal=function(t){var e=i.props.user.memorials.find(function(t){return t.urlNm===i.props.urlNm});i.setState({showModal:!0,item:e.items.find(function(e){return e.id===t})})},i.hideModal=function(){var t=i.state.item;t.edited=!0,i.setState({showModal:!1,modalError:!1,oldItem:t})},i.newItem=function(){i.showModal(),i.setState({item:{}})},o=n,l(i,o)}return s(e,t),e.prototype.render=function(){var t=this,e=this.props.user.memorials.find(function(e){return e.urlNm===t.props.urlNm});return Object(r.h)(d.a,{avatarColumn:Object(r.h)("div",{class:"menu",style:"z-index:1;"},Object(r.h)("figure",{class:"centered avatar avatar-xxl"},Object(r.h)("img",{src:e.avatar})),Object(r.h)("h3",{class:"text-center mt-2"},e.nm)),contentColumn:Object(r.h)("div",null,Object(r.h)(p,{showModal:this.showModal,items:e.items,newItem:this.newItem}),Object(r.h)(x,{showModal:this.state.showModal,hideModal:this.hideModal,updChronicle:this.updChronicle,newChronicle:this.newChronicle,onChange:this.onChange,onFileChange:this.onFileChange,item:this.state.item}))})},e}(r.Component);e.default=M},cUJj:function(t){t.exports={gridContainer:"gridContainer__3MQ5X",avatarColumn:"avatarColumn__3AYMn",contentColumn:"contentColumn__2un7q"}},"v23/":function(t,e,n){"use strict";var i=n("KM04"),o=(n.n(i),n("cUJj")),a=n.n(o);e.a=function(t){return Object(i.h)("div",{class:a.a.gridContainer},Object(i.h)("div",{class:a.a.avatarColumn},t.avatarColumn),Object(i.h)("div",{class:a.a.contentColumn},t.contentColumn))}}});
//# sourceMappingURL=route-ManageMemorial.chunk.20d7e.js.map