webpackJsonp([7],{FoBm:function(t,e,n){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var v=n("KM04"),O=n("/C1n"),j=n("/QC5"),g=n("v23/"),y=Object(v.h)("h4",{class:"col"},"Chronicle Items"),w=Object(v.h)("div",{class:"col"}),C=Object(v.h)("div",{class:"divider"}),S=function(t){return Object(v.h)("div",null,Object(v.h)("div",{class:"row"},y,w,Object(v.h)("button",{class:"col btn btn-primary",onClick:t.newItem},"Add Item")),C,Object(v.h)("div",{style:"display:flex;flex-direction:row;flex-wrap:wrap;align-items:flex-start;justify-content:center;"},t.items.map(function(e){return Object(v.h)(x,{id:e.id,title:e.title,date:e.start,location:e.location,src:e.src,showModal:function(e){return t.showModal(e)},edited:e.edited})})))},x=function(t){return Object(v.h)("div",{class:"card m-2",style:"width:200px;"},t.src&&Object(v.h)("img",{class:"responsive-img mt-2 mx-2 centered",src:t.src,style:"max-width:182px"}),Object(v.h)("div",{class:"card-body"},Object(v.h)("div",{class:"h6 text-ellipsis"},t.title),Object(v.h)("div",{class:"text-gray text-ellipsis",style:"font-size:smaller;"},t.location),Object(v.h)("div",{class:"text-gray",style:"font-size:smaller;"},t.date)),Object(v.h)("div",{class:"card-footer"},Object(v.h)("button",{class:"btn btn-sm float-right",onClick:function(){return t.showModal(t.id)}},"edit")))},E=S,k=n("9qb7"),M=n.n(k),_=n("AM5m"),I=function(t){return Object(v.h)("div",{class:"panel"},Object(v.h)("div",{class:"panel-body mt-2"},t.item.src&&Object(v.h)("img",{src:t.item.src,alt:t.item.title,class:"img-responsive my-2"}),Object(v.h)("h4",null,t.item.title),Object(v.h)("div",{class:"text-gray d-inline"},t.item.location),Object(v.h)("div",{class:"text-gray d-inline mx-2"},t.item.start),Object(v.h)("p",null,t.item.caption)))},T=I,N=Object(v.h)("div",{class:"text-center text-gray",style:"font-size:smaller;"},"- Scroll down to see a preview -"),P=function(t){function e(){return i(this,t.apply(this,arguments))}return a(e,t),e.prototype.render=function(t){var e=M()("modal","modal-lg",{active:t.showModal},{"has-error":t.modalError}),n=window.innerWidth||document.documentElement.clientWidth||document.body.client.width;return Object(v.h)("div",{class:e},Object(v.h)("a",{onClick:t.hideModal,class:"modal-overlay","aria-label":"Close"}),Object(v.h)("div",{class:"modal-container"},Object(v.h)("div",{class:"modal-header"},Object(v.h)("a",{onClick:t.hideModal,class:"btn btn-clear float-right","aria-label":"Close"}),Object(v.h)("div",{class:"modal-title h5"},t.item.id?"Edit Item":"Add Item"),n<840&&N),Object(v.h)("div",{class:"modal-body"},Object(v.h)("div",{class:n<840?"content":"content container columns"},Object(v.h)("form",{class:n<840?"form-group":"form-group column col-5"},Object(v.h)(_.e,{label:"Title",name:"title",value:t.item.title,onChange:t.onChange}),Object(v.h)(_.e,{label:"Location",name:"location",value:t.item.location,onChange:t.onChange}),Object(v.h)(_.a,{label:"Date",name:"start",value:t.item.start,onChange:t.onChange}),Object(v.h)("label",{class:"form-label"},"Change photo",Object(v.h)("input",{class:"form-input",type:"file",accept:".jpg, .jpeg, .png",value:t.item.file,onChange:t.onFileChange}))),Object(v.h)("div",{class:n<840?"":"column col-7"},Object(v.h)(T,{item:t.item})))),Object(v.h)("div",{class:"modal-footer"},Object(v.h)("button",{class:"btn btn-primary",onClick:t.item.id?t.updChronicle:t.newChronicle},t.item.id?"Update item":"Add item"))))},e}(v.Component),A=P,U=Object(v.h)("h4",null,"Bulk Import"),R=function(t){function e(){var n,i,a;o(this,e);for(var s=arguments.length,r=Array(s),c=0;c<s;c++)r[c]=arguments[c];return n=i=l(this,t.call.apply(t,[this].concat(r))),i.state={files:[],filesUploaded:0},i.onFileChange=function(t){i.setState({files:t.target.files,filesUploaded:0})},i.bulkImport=function(){i.setState({filesUploaded:0});var t=i.state.files;if(0===t.length)return void alert("No files selected.");var e=0,n=function(){return t[e++]};!function t(e){var a=new FileReader;a.readAsDataURL(e),a.onload=function(e){var a=e.target.result.split(",")[1];fetch(O.a+"!newChronicle",{method:"POST",body:JSON.stringify({loginToken:window.sessionStorage.getItem("loginToken"),urlNm:i.props.urlNm,image:a})}).then(function(t){return t.json()}).then(function(e){i.setState(function(t){return{filesUploaded:t.filesUploaded+1}}),t(n()),console.log(e)})}}(n())},a=n,l(i,a)}return s(e,t),e.prototype.render=function(){return Object(v.h)("div",{class:"row",style:"margin-bottom:32px;"},U,Object(v.h)("input",{class:"form-input col",style:"max-width:400px",type:"file",accept:".png, .jpg, .jpeg",value:this.state.files,onChange:this.onFileChange,multiple:!0}),Object(v.h)("button",{class:"btn btn-primary col float-right",onClick:this.bulkImport}," Bulk Import"),this.state.filesUploaded>0&&Object(v.h)("div",null,Object(v.h)("div",{class:"bar"},Object(v.h)("div",{class:"bar-item",role:"progressbar",style:"width:"+this.state.filesUploaded/this.state.files.length*100+"%;","aria-valuenow":this.state.filesUploaded.toString(),"aria-valuemin":"0","aria-valuemax":this.state.files.length.toString()})),Object(v.h)("div",null,this.state.filesUploaded,"/",this.state.files.length," uploaded")))},e}(v.Component),F=R,L=n("khkS"),J=n.n(L),z=n("3F7m"),D=n.n(z),W=Object(v.h)("div",{class:"text-center text-gray",style:"font-size:smaller;"},"- Scroll down to see a preview -"),B=Object(v.h)("div",{class:"modal-footer"}),q=function(t){function e(n){r(this,e);var i=c(this,t.call(this,n));return i.onChange=function(t){var e;i.setState((e={},e[t.target.name]=t.target.value,e))},D.a.setOptions({sanitize:!0}),i.state={invitation:i.props.memorial.invitation||""},i}return h(e,t),e.prototype.render=function(t){var e=M()("modal","modal-lg",{active:t.showModal},{"has-error":t.modalError}),n=(M()("form-input-hint","float-left",{"d-hide":!t.modalError}),window.innerWidth||document.documentElement.clientWidth||document.body.client.width);return Object(v.h)("div",{class:e},Object(v.h)("a",{onClick:t.hideModal,class:"modal-overlay","aria-label":"Close"}),Object(v.h)("div",{class:"modal-container"},Object(v.h)("div",{class:"modal-header"},Object(v.h)("a",{onClick:t.hideModal,class:"btn btn-clear float-right","aria-label":"Close"}),Object(v.h)("div",{class:"modal-title h5"},"Edit Invitation to ",t.memorial.nm1,"'s Memorial"),n<840&&W),Object(v.h)("div",{class:"modal-body"},Object(v.h)("div",{class:n<840?"content":"content container columns"},Object(v.h)("form",{class:n<840?"form-group":"form-group column col-5"},Object(v.h)("textarea",{class:"form-input",rows:"16",value:this.state.invitation,onInput:this.onChange,name:"invitation"})),Object(v.h)("div",{class:n<840?"card":"card column col-7"},Object(v.h)("div",{class:"card-body",dangerouslySetInnerHTML:{__html:D()(this.state.invitation)}})))),B))},e}(v.Component),H=q,K=(n("wI7h"),Object(v.h)("h4",{class:"col",style:"width:80%"},"Invite Others to Contribute")),Q=Object(v.h)("span",{class:"input-group-addon addon-sm"},Object(v.h)("i",{class:"icon icon-search"})),V=Object(v.h)("h5",null,"You haven't invited anyone yet"),Y=Object(v.h)("label",{class:"form-label"},"Enter email addresses"),G=function(t){function e(){var n,i,a;u(this,e);for(var o=arguments.length,l=Array(o),s=0;s<o;s++)l[s]=arguments[s];return n=i=d(this,t.call.apply(t,[this].concat(l))),i.state={email:"",emails:[],emailError:!1,active:!1,filter:"",showModal:!1},i.onChange=function(t){var e;i.setState((e={},e[t.target.name]=t.target.value,e))},i.hideModal=function(){i.setState({showModal:!1})},i._handleEmailChange=function(t){i.setState({email:t.target.value})},i._addEmail=function(t){if(t.preventDefault(),!J()(i.state.email))return void i.setState({emailError:!0});i.setState({emailError:!1}),i.setState({emails:[].concat(i.state.emails,[i.state.email]),email:""})},i._removeEmail=function(t){var e=i.state.emails.filter(function(e){return e!==t.target.name});i.setState({emails:e})},i.updEmails=function(){fetch(O.a+"!updEmails",{method:"POST",body:JSON.stringify({emails:i.state.emails,memorial:i.props.memorial.urlNm,loginToken:window.sessionStorage.getItem("loginToken")})}).then(function(t){return t.json()}).then(function(t){console.log(t)})},a=n,d(i,a)}return m(e,t),e.prototype.render=function(){var t=this,e=M()("form-group",{"has-error":this.state.emailError}),n=M()("form-input-hint",{"d-hide":!this.state.emailError});return Object(v.h)("div",null,Object(v.h)("div",{class:"row my-2"},K,Object(v.h)("button",{class:"btn btn-primary col",onClick:function(){return t.setState({showModal:!0})}}," Edit Invitation")),Object(v.h)(H,{memorial:this.props.memorial,showModal:this.state.showModal,hideModal:this.hideModal}),this.props.memorial.emails?Object(v.h)("div",null,Object(v.h)("span",{class:"badge","data-badge":this.props.memorial.emails.length.toString()},"Invitations Sent"),Object(v.h)("span",null,this.state.active?Object(v.h)("div",{class:"d-inline"},Object(v.h)("button",{class:"btn btn-sm ml-2",onClick:function(){return t.setState({active:!1})}}," hide"),Object(v.h)("div",{class:"input-group float-right"},Q,Object(v.h)("input",{class:"form-input input-sm",type:"text",value:this.state.filter,onInput:this.onChange,name:"filter"}))):Object(v.h)("button",{class:"btn btn-sm ml-2",onClick:function(){return t.setState({active:!0})}}," show")),this.state.active&&Object(v.h)("div",{class:"my-2"},""!==this.state.filter?this.props.memorial.emails.filter(function(e){return e.includes(t.state.filter)}).map(function(t){return Object(v.h)("span",{class:"chip"},t)}):this.props.memorial.emails.map(function(t){return Object(v.h)("span",{class:"chip"},t)}))):V,Object(v.h)("form",{class:e},Y,Object(v.h)("div",{class:"input-group"},Object(v.h)("input",{type:"email",class:"form-input",value:this.state.email,onChange:this._handleEmailChange}),Object(v.h)("button",{class:"btn btn-primary input-group-btn",type:"submit",onClick:this._addEmail},"Add")),Object(v.h)("p",{class:n},"Please enter a valid email address")),Object(v.h)("div",{class:"mt-2"},this.state.emails.map(function(e){return Object(v.h)("span",{class:"chip"},e,Object(v.h)("a",{class:"btn btn-clear","aria-label":"Close",role:"button",onClick:t._removeEmail,name:e}))})),Object(v.h)("div",{class:"row my-2"},Object(v.h)("button",{class:"btn btn-primary float-right",onClick:this.updEmails}," Send Invitations")))},e}(v.Component),X=G,Z=Object(v.h)("div",{class:"divider"}),$=Object(v.h)("div",null,"This is the Atlas component"),tt=Object(v.h)("div",null,"This is the Shrine component"),et=function(t){function e(){var n,i,a;f(this,e);for(var o=arguments.length,l=Array(o),s=0;s<o;s++)l[s]=arguments[s];return n=i=b(this,t.call.apply(t,[this].concat(l))),i.state={item:{},showModal:!1,active:"chronicle"},i.onChange=function(t){var e=i.state.item;e[t.target.name]=t.target.value,i.setState({oldState:e})},i.onFileChange=function(t){var e=i.state.item;e.file=t.target.files[0],i.setState({oldState:e}),i.makeFileURL()},i.makeFileURL=function(){var t=i.state.item,e=new FileReader;e.onload=function(e){t.src=e.target.result,i.setState({oldState:t})},e.readAsDataURL(i.state.item.file)},i.updChronicle=function(){if(console.log("updChronicle"),!i.state.item.title||!i.state.item.start)return void alert("A new item must have a title and a date");if(i.state.item.file){var t=new FileReader;t.readAsDataURL(i.state.item.file),t.onload=function(t){var e=t.target.result.split(",")[1];fetch(O.a+"!updChronicle",{method:"POST",body:JSON.stringify({loginToken:window.sessionStorage.getItem("loginToken"),urlNm:i.props.urlNm,id:i.state.item.id,title:i.state.item.title,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt,image:e})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).then(i.setState({item:{}}))}}else fetch(O.a+"!updChronicle",{method:"POST",body:JSON.stringify({loginToken:window.sessionStorage.getItem("loginToken"),urlNm:i.props.urlNm,id:i.state.item.id,title:i.state.item.title,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt})}).then(function(t){return t.json()}).then(function(t){console.log(t)}).then(i.setState({item:{}}));i.hideModal()},i.newChronicle=function(){if(console.log("newChronicle"),!i.state.item.title||!i.state.item.start)return void alert("A new item must have a title and a date");if(i.state.item.file){var t=new FileReader;t.readAsDataURL(i.state.item.file),t.onload=function(t){var e=t.target.result.split(",")[1];fetch(O.a+"!newChronicle",{method:"POST",body:JSON.stringify({urlNm:i.props.urlNm,title:i.state.item.title,subtitle:i.state.item.subtitle,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt,image:e})}).then(function(t){return t.json()}).then(function(t){console.log(t),i.addItem(t)}).then(i.setState({item:{}}))}}else fetch(O.a+"!newChronicle",{method:"POST",body:JSON.stringify({urlNm:i.props.urlNm,title:i.state.item.title,subtitle:i.state.item.subtitle,location:i.state.item.location,date:i.state.item.start,txt:i.state.item.txt})}).then(function(t){return t.json()}).then(function(t){console.log(t),i.addItem(t)}).then(i.setState({item:{}}));i.hideModal()},i.showModal=function(t){var e=i.props.user.memorials.find(function(t){return t.urlNm===i.props.urlNm});i.setState({showModal:!0,item:e.items.find(function(e){return e.id===t})})},i.hideModal=function(){var t=i.state.item;t.edited=!0,i.setState({showModal:!1,modalError:!1,oldItem:t})},i.newItem=function(){i.showModal(),i.setState({item:{}})},a=n,b(i,a)}return p(e,t),e.prototype.render=function(){var t=this,e=this.props.user.memorials.find(function(e){return e.urlNm===t.props.urlNm});return Object(v.h)(g.a,{avatarColumn:Object(v.h)("div",{class:"menu",style:"z-index:1;"},Object(v.h)("figure",{class:"centered avatar avatar-xxl"},Object(v.h)("img",{src:e.avatar})),Object(v.h)("h3",{class:"text-center mt-2"},e.nm),Z,Object(v.h)("li",{class:"menu-item"},Object(v.h)(j.Link,{class:"menu-item",href:"/"+e.urlStr+"/"+e.urlNm+"/chronicle"},"View Chronicle"))),contentColumn:Object(v.h)("div",null,Object(v.h)("ul",{class:"tab tab-block"},Object(v.h)("li",{class:"tab-item c-hand "+("chronicle"===this.state.active?"active":"")},Object(v.h)("a",{onClick:function(){return t.setState({active:"chronicle"})}},"Chronicle")),Object(v.h)("li",{class:"tab-item c-hand "+("atlas"===this.state.active?"active":"")},Object(v.h)("a",{onClick:function(){return t.setState({active:"atlas"})}}," Atlas")),Object(v.h)("li",{class:"tab-item c-hand "+("shrine"===this.state.active?"active":"")},Object(v.h)("a",{onClick:function(){return t.setState({active:"shrine"})}},"Shrine")),Object(v.h)("li",{class:"tab-item c-hand "+("invitations"===this.state.active?"active":"")},Object(v.h)("a",{onClick:function(){return t.setState({active:"invitations"})}}," Invitations"))),"chronicle"===this.state.active&&Object(v.h)("div",null,Object(v.h)(F,{urlNm:e.urlNm}),Object(v.h)(E,{showModal:this.showModal,items:e.items,newItem:this.newItem}),Object(v.h)(A,{showModal:this.state.showModal,hideModal:this.hideModal,updChronicle:this.updChronicle,newChronicle:this.newChronicle,onChange:this.onChange,onFileChange:this.onFileChange,item:this.state.item})),"atlas"===this.state.active&&$,"shrine"===this.state.active&&tt,"invitations"===this.state.active&&Object(v.h)(X,{memorial:e}))})},e}(v.Component);e.default=et}});
//# sourceMappingURL=route-ManageMemorial.chunk.b95cd.js.map